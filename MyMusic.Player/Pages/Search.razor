@page "/search"
@page "/search/{SearchQuery?}"

@if (Model is not null && Model.items is not null && !_searching)
{
  @if (!string.IsNullOrEmpty(NextPageToken))
  {
    <div class="w-100 text-center mb-1">
      <RadzenButton ButtonStyle="ButtonStyle.Info" Click="async () => await SearchAsync()">
          Next results
        <RadzenIcon Icon="navigate_next" />
      </RadzenButton>
    </div>
  }
  <RadzenRow>
    @foreach (var model in Model.items)
    {
      <RadzenColumn Size="2">
        <RadzenStack class="h-100" style="min-height: 100% !important" Orientation="Orientation.Vertical">
          <RadzenCard>
            <RadzenImage class="img-fluid img-thumbnail" Path="@model.snippet.thumbnails.FirstOrDefault().url" />
            <br />
            <span><b>@model.snippet.title</b></span>
            <br />
            <RadzenButton Click="async () => { await SendDownloadRequest(model); }" class="w-100" Text="@model.snippet.duration.ConvertIntToStringTime()" Size="ButtonSize.Small" ButtonStyle="ButtonStyle.Info" Icon="cloud_download" />
          </RadzenCard>
        </RadzenStack>
      </RadzenColumn>
    }
  </RadzenRow>
  @if (!string.IsNullOrEmpty(NextPageToken))
  {
    <div class="w-100 text-center mt-1">
      <RadzenButton ButtonStyle="ButtonStyle.Info" Click="async () => await SearchAsync()">
        Next results
        <RadzenIcon Icon="navigate_next" />
      </RadzenButton>
    </div>
  }
}
else if (_searching)
{
  <div class="w-100 h-100">
    <RadzenProgressBarCircular class="m-auto mt-5" Mode="ProgressBarMode.Indeterminate" Size="ProgressBarCircularSize.Large">
      <Template>Searching</Template>
    </RadzenProgressBarCircular>
  </div>
}
else
{
  <div class="w-100 h-100 mt-5 text-center">
    <b>Find the next best song.....</b>
  </div>
}